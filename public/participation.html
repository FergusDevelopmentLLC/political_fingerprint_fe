<!DOCTYPE html>
<html>

<head>
  <link href='styles/style.css' rel='stylesheet' type='text/css'>
  <title>PolitiPoint.org</title>
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <script src="mapData/d3/counties.js"></script>
</head>

<body>
  <div class='quiz-logo-wrapper'>
    <img src="https://res.cloudinary.com/fergusdev/image/upload/v1602701055/politipoint/logos/politipoint-wordmark-color_ewmxr1.png" />
  </div>
  <hr />
  <h5>Many Thanks!</h5>
  <p>
    We very much appreciate your feedback, and as mentioned, it will be use to improve question wording in upcoming versions of PolitiPoint. 
    Gibbet maroon scuttle quarterdeck bilged on her anchor fire in the hole dance the hempen jig Yellow Jack fathom belaying pin. 
    Provost red ensign fluke ahoy clap of thunder execution dock gaff loot Privateer brigantine. Take a caulk pink killick rigging 
    barkadeer carouser strike colors plunder crack Jennys tea cup weigh anchor. League overhaul aft hulk pressgang holystone prow reef sails 
    loot scourge of the seven seas. Crow's nest haul wind fathom hogshead draft aft keelhaul transom Pieces of Eight chase guns. Mutiny 
    avast spanker scuttle tack sloop carouser booty pinnace fore.
  </p>
  <h5>Location</h5>
  <p>Based on your IP address, your local county has been approximated to be: <strong>Denver County, CO</strong>.</p>

  <p>You may choose your county affilitiation the approximated county is incorrect or you wish to affiliate your results with another U.S. county.</p>
  
  <div>
    <select id="stateSel" size="1">
      <option value="" selected="selected">-Select state-</option>
    </select>
    <br/>
    <br/>
    <select id="countySel" size="1">
      <option value="" selected="selected">-Select county-</option>
    </select>
  </div>

  <div>
    <input type="checkbox" id="optinout" class="optin-out-checkbox" checked="checked" />
    <label for="optinout">I agree to share my test results to PolitiPoint and have them be averaged and aggregated by county into a national map.</label>
  </div>

  <script>

    let stateCounty = [
      {
        "name": "Colorado",
        "abbrev": "CO",
        "geoid": "08031",
        "counties": [
          {
            "name": "Denver",
            "geoid": "08059"
          },
          {
            "name": "Jefferson",
            "geoid": "08058"
          }
        ]
      },
      {
        "name": "Illinois",
        "abbrev": "IL",
        "geoid": "08032",
        "counties": [
          {
            "name": "Will",
            "geoid": "08049"
          },
          {
            "name": "Cook",
            "geoid": "08039"
          }
        ]
      }
    ]


    window.onload = () => {
      
      let stateSelect = document.getElementById("stateSel")	
      let countySelect = document.getElementById("countySel")
      
      for(let state of stateCounty) {
        stateSel.options[stateSel.options.length] = new Option(state.name, state.geoid)
      }

      //hm. cannot use arrow function here, why?
      stateSelect.onchange = function () {		 
        
        //https://stackoverflow.com/questions/3364493/how-do-i-clear-all-options-in-a-dropdown-box
        //wow, lots of discussion on this.
        countySelect.length = 1
        
        if (this.selectedIndex < 1) return

        let countiesForState = stateCounty.filter(state => {
          return state.geoid === this.value
        })

        for (county of countiesForState[0].counties) {
          countySelect.options[countySelect.options.length] = new Option(`${county.name} County`, county.geoid)
        }
      }
    }
    
  </script>
</body>

</html>